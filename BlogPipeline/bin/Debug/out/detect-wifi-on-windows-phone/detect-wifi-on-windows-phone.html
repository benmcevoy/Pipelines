<p>If you are making web requests on the windows phone you should check network availability first.  </p>

<pre class='prettyprint'><code>
     Microsoft.Phone.Net.NetworkInformation.DeviceNetworkInformation.IsNetworkAvailable
</code></pre>

<p>If you are trying to be a conscientious developer you may only want to make web requests when the phone is connected to a wifi network, for instance in a background agent update.</p>

<p>The API offers:</p>

<pre class='prettyprint'><code>
     DeviceNetworkInformation.IsWiFiEnabled
</code></pre>

<p>This, however only tells you the user has wifi enabled.  It does not tell you if the phone is connected and using a wifi network. </p>

<p>You must also check the <em><a href="http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.net.networkinformation.networkinterfacetype(v=vs.105).aspx">NetworkInterfaceType</a></em>.  Note that the majority of interface types are not supported on the phone. There is really only <strong>Wireless80211</strong>, <strong>MobileBroadbandGsm</strong> and <strong>MobileBroadbandCdma</strong> to worry about.  I <em>believe</em> <strong>Ethernet</strong> is available when connected to a PC with Zune running, as I <em>think</em> Zune allows the phone to piggy back off the PC's network connection. AFAIK.</p>

<pre class='prettyprint'><code>
    NetworkInterface.NetworkInterfaceType == NetworkInterfaceType.Wireless80211
</code></pre>

<p>Put it all together.</p>

<pre class='prettyprint'><code>

        private bool IsWifiConnected()
        {
            if(IsNetworkAvailable() && IsWifiEnabled())
            {
                return NetworkInterface.NetworkInterfaceType == NetworkInterfaceType.Wireless80211;
            }

            return false;
        }

        private bool IsWifiEnabled()
        {
            return DeviceNetworkInformation.IsWiFiEnabled;
        }

        private bool IsNetworkAvailable()
        {
            return DeviceNetworkInformation.IsNetworkAvailable;
        }


</code></pre>

<h3>This thing is slooooow</h3>

<p>After implementing something like this in a background agent on the phone, I was surprised to see the agent frequently not running correctly, usually timing out.</p>

<p>As far as as I can tell, the call to <strong>NetworkInterface.NetworkInterfaceType</strong> can be very slow, sometimes 20-30 seconds, and sometimes simply returning <em>None</em>, even though the phone is clearly connected to the network.</p>

<p>People on stackoverflow suggest wrapping these calls up in some async pattern, either threadpool or whatever, as it will be a blocking call otherwise.</p>

<p>In the case of a background agent I can't see how to determine if we are on a wifi network (or connected at all) in a timely manner.  The background task must complete in, I think, 25 seconds or so.  If the network takes 20-30 seconds, well you can see the problem.</p>

<h3>WIFI is sleeping</h3>

<p>The phone has certain behaviors you must be aware of.</p>

<ul>
<li>wifi will turn off if the phone is asleep</li>
<li>the phone will preferentially use the mobile connection</li>
</ul>

<p>On the windows phone 8 a recent update allows the user to specify "Keep WiFi on when screen times out".</p>

<p>On windows phone 7.5 it seems to keep WiFi on by default. I am not sure.</p>

<p>Basically, during a background task:</p>

<ul>
<li>if the user has wifi enabled and mobile data turned on the phone will opt for mobile data</li>
<li>if the user has wifi enabled and wifi enabled during sleep (and mobile data) the phone <em>should</em> opt for wifi</li>
<li>if the user has wifi enabled, wifi enabled during sleep and mobile data off, the check for network will succeed (uses wifi)</li>
<li>if the user has wifi enabled, mobile data off, the check for network will fail (timeout)</li>
<li>if the user has wifi disabled, mobile data on, the check for network will  succeed (uses mobile data)</li>
</ul>

<p>At the end of the day the best you can do is inform your users.</p>

<p>"If you wish to use wifi for background data requests please check "Keep WiFi on when screen times out" is enabled under the advanced settings of your wifi connection." </p>
